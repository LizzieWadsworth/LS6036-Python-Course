[
  {
    "objectID": "worksheets/vcf_count_positions_in_window.html",
    "href": "worksheets/vcf_count_positions_in_window.html",
    "title": "Counting positions in a window",
    "section": "",
    "text": "The allel library has some useful built-in functions we can use to get a clearer picture of our data. For example, we can use windowed_count to get a count of all the variant positions for the first n base pairs, and then the next n base pairs…\nTo do this, first we need our positions numbers and which chromosomes they belong to:\nimport allel # import sci-kit allel\nmosq_vcf_file = allel.read_vcf(\"mosquito_samples.vcf.gz\" ) # Read vcf file and set up \n# Extract positions and chromosomes\npos   = mosq_vcf_file['variants/POS']\nchrom = mosq_vcf_file['variants/CHROM']\nNext, we want to look at just one chromosome at a time. We can do this by creating a list of all of the positions which correspond to the chromosome we want, using:\nchrom_name = \"2L\" # Select chromosome of interest \nwindow_size = 50000 # Scan every 50,000 base pairs\nchosen_positions = [] # Empty list to contain all of the positions for our chromosome\n\n# for loop to go from 0 to length of position list \nfor i in range(len(pos)): \n    # if statement to check if chromosome matches our chosen chromosome\n    if chrom[i] == chrom_name:\n        # If true, add positions to list\n        chosen_positions.append(pos[i])\nFinally, we can use the allel.windowed_count() function to count how many variant positions there are in the first 50,000 base pairs, and then the second 50,000 base pairs, and so on.\n# Function allel.windowed_count takes a list of positions and a window size as arguments\n# Returns the counts and locations for each window \ncounts, locations = allel.windowed_count(chosen_positions, size=window_size)\n\n# Loop through the results from 0 to length of counts\nfor i in range(len(counts)):\n    # Extract number of variants, start and stop positions from results\n    variants = counts[i]\n    start_position = locations[i][0]\n    stop_position = locations[i][1]\n    # Print the results\n    print(f\"{variants} varients found between {start_position} and {stop_position}\")\n554 varients found between 163 and 50162\n1288 varients found between 50163 and 100162\n650 varients found between 100163 and 150162\n897 varients found between 150163 and 199333",
    "crumbs": [
      "Learn",
      "**Functions**",
      "VCF files",
      "Counting positions in a window"
    ]
  },
  {
    "objectID": "worksheets/vcf_count_positions_in_window.html#give-it-a-go",
    "href": "worksheets/vcf_count_positions_in_window.html#give-it-a-go",
    "title": "Counting positions in a window",
    "section": "Give it a go:",
    "text": "Give it a go:\nCan you plot the number of variants in each window on a graph?",
    "crumbs": [
      "Learn",
      "**Functions**",
      "VCF files",
      "Counting positions in a window"
    ]
  },
  {
    "objectID": "worksheets/vcf_data_2.html",
    "href": "worksheets/vcf_data_2.html",
    "title": "Extract values from VCF",
    "section": "",
    "text": "Viewing all the data will give a really large table, so it can be useful to instead extract just some of the data we need.\nFor instance, we can print just the samples found, count the number of positions or make a list of all the chromosomes.\n\nSamplesPositionsChromosomes\n\n\nThe key \"samples\" will already give us a list of samples:\n\nimport allel # import sci-kit allel\nmosq_vcf_file = allel.read_vcf(\"mosquito_samples.vcf.gz\" ) # Read vcf file and set up \n\n# Extract samples\nsamples = mosq_vcf_file['samples']\nprint(\"Samples:\", samples) # print samples\n\n\n\nSamples: ['AC0090-C' 'AR0047-C']\n\n\n\n\nThe key \"POS\" will give us a list of all positions where there is a variant. We can get the total number of positions with len()\n\nimport allel # import sci-kit allel\nmosq_vcf_file = allel.read_vcf(\"mosquito_samples.vcf.gz\" ) # Read vcf file and set up \n\n# Extract positions\npos = mosq_vcf_file['variants/POS']\nprint(\"Number of variants:\", len(pos))\n\n\n\nNumber of variants: 12347\n\n\n\n\nThe key \"CHROM\" will give us the chromosome for each position of each variant. This means the same chromosome will appear multiple times.\nTo get unique chromosomes, we can create a list of chromosomes and then loop through the full list - only adding chromosomes to our list that we haven’t already added.\n\nimport allel # import sci-kit allel\nmosq_vcf_file = allel.read_vcf(\"mosquito_samples.vcf.gz\" ) # Read vcf file and set up \n\n# Extract chromosomes\nchromes = mosq_vcf_file[\"variants/CHROM\"]\nchrom_list = [] # create an empty list \nfor i in chromes: \n    # Loop through every chromosome in chromes\n    if i not in chrom_list: \n        # Check if it is not already in our list, and if so add it\n        chrom_list.append(i)\n# print the final list\nprint(chrom_list)\n\n\n\n['2L', '2R', '3L', '3R', 'X']\n\n\nThis matches what we expect - mosquitos have three chromosomes which can be separated into left (L) and right (R) arms.\n\n\n\nMosquito karyotype with X, 2 and 3 annotated. CC = chromocenter. From Artemov et al., 2021",
    "crumbs": [
      "Learn",
      "**Functions**",
      "VCF files",
      "Extract values from VCF"
    ]
  }
]